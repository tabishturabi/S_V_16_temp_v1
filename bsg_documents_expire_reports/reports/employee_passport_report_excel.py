from odoo import models
from datetime import datetime
from odoo.exceptions import UserError,ValidationError
import xlsxwriter
import collections, functools, operator
from collections import OrderedDict
from ummalqura.hijri_date import HijriDate


class EmployeePassportReportExcel(models.AbstractModel):
    _name = 'report.bsg_documents_expire_reports.passport_report_xlsx'
    _inherit ='report.report_xlsx.abstract'


    def generate_xlsx_report(self, workbook,lines,data=None):
        main_heading = workbook.add_format({
            "bold": 0,
            "border": 1,
            "align": 'center',
            "valign": 'vcenter',
            "font_color": 'black',
            "bg_color": 'white',
            'font_size': '10',
        })
        main_heading2 = workbook.add_format({
            "bold": 1,
            "border": 1,
            "align": 'left',
            "valign": 'vcenter',
            "font_color": 'black',
            "bg_color": '#acadb2',
            'font_size': '12',
        })
        sheet = workbook.add_worksheet('Employees Passport Report')
        # sheet.set_column('A2:A2',30)
        sheet.set_column('A:M', 20)
        row = 0
        col = 0
        if data.mode == 'all':
            if data.grouping_by == 'all':
                sheet.write(row, col, 'Employee ID', main_heading2)
                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                sheet.write(row, col + 2, 'Department Name', main_heading2)
                sheet.write(row, col + 3, 'Branch Name', main_heading2)
                sheet.write(row, col + 4, 'Company Name', main_heading2)
                sheet.write(row, col + 5, 'Passport NO', main_heading2)
                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                sheet.write(row, col + 11, 'Job Position', main_heading2)
                sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                sheet.write(row, col + 14, 'Passport Status', main_heading2)
                #line removed
                row += 1
                sheet.write(row, col, 'هوية الموظف', main_heading2)
                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                sheet.write(row, col + 5, 'رقم جواز السفر', main_heading2)
                sheet.write(row, col + 6, 'اسم جواز السفر', main_heading2)
                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                sheet.write(row, col + 11, 'وظيفه', main_heading2)
                sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                # line removed
                row += 1
                if data.employee_state == 'all':
                    employee_ids = self.env['hr.employee'].search([])
                else:
                    employee_ids = self.env['hr.employee'].search([('employee_state', '=', data.employee_state)])
                for employee_id in employee_ids:
                    if employee_id:
                        if data.expire_date_condition == 'all':
                            passport_id = self.env['hr.passport'].search([('bsg_employee_id', '=', employee_id.id)])
                        if data.expire_date_condition == 'is_equal_to':
                            passport_id = self.env['hr.passport'].search([('bsg_employee_id', '=', employee_id.id), (
                                'bsg_expirydate', '=', data.expiry_date)])
                        if data.expire_date_condition == 'is_not_equal_to':
                            passport_id = self.env['hr.passport'].search([('bsg_employee_id', '=', employee_id.id), (
                                'bsg_expirydate', '!=', data.expiry_date)])
                        if data.expire_date_condition == 'is_after':
                            passport_id = self.env['hr.passport'].search([('bsg_employee_id', '=', employee_id.id), (
                                'bsg_expirydate', '>', data.expiry_date)])
                        if data.expire_date_condition == 'is_before':
                            passport_id = self.env['hr.passport'].search([('bsg_employee_id', '=', employee_id.id), (
                                'bsg_expirydate', '<', data.expiry_date)])
                        if data.expire_date_condition == 'is_after_or_equal_to':
                            passport_id = self.env['hr.passport'].search([('bsg_employee_id', '=', employee_id.id), (
                                'bsg_expirydate', '>=', data.expiry_date)])
                        if data.expire_date_condition == 'is_before_or_equal_to':
                            passport_id = self.env['hr.passport'].search([('bsg_employee_id', '=', employee_id.id), (
                                'bsg_expirydate', '<=', data.expiry_date)])
                        if data.expire_date_condition == 'is_between':
                            passport_id = self.env['hr.passport'].search([('bsg_employee_id', '=', employee_id.id),
                                                                    ('bsg_expirydate', '>', data.date_from),
                                                                    ('bsg_expirydate', '<', data.date_to)])
                        if data.expire_date_condition == 'is_set':
                            passport_id = self.env['hr.passport'].search(
                                [('bsg_employee_id', '=', employee_id.id), ('bsg_expirydate', '=', data.expiry_date)])
                        if data.expire_date_condition == 'is_not_set':
                            passport_id = self.env['hr.passport'].search([('bsg_employee_id', '=', employee_id.id), (
                                'bsg_expirydate', '=', data.expiry_date)])
                        for passport in passport_id:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
            if data.grouping_by == 'by_branch':
                branch_ids = self.env['bsg_branches.bsg_branches'].search([])
                grand_total = 0
                for branch_id in branch_ids:
                    if branch_id:
                        if data.expire_date_condition == 'all':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','=',branch_id.id)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.branch_id','=',branch_id.id)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','=',branch_id.id),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.branch_id','=',branch_id.id),
                                                                           ('bsg_employee_id.employee_state', '=',data.employee_state)])
                        if data.expire_date_condition == 'is_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','=',branch_id.id),
                                                                         ('bsg_expirydate', '=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.branch_id','=',branch_id.id),
                                                                                 ('bsg_expirydate', '=',data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=',branch_id.id),
                                                                         ('bsg_expirydate', '=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.branch_id', '=',branch_id.id),
                                                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_not_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '!=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '!=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '!=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_before':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '<', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '<', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '<', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '<', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_after':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '>', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '>', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '>', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '>', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_after_or_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '>=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '>=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '>=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_before_or_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '<=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '<=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '<=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_between':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '>', data.date_from),
                                     ('bsg_expirydate', '<', data.date_to)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '>', data.date_from),
                                     ('bsg_expirydate', '<', data.date_to),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_set':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '!=', None)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '!=', None)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '!=', None),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '!=', None),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_not_set':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '=', None)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '=', None)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', branch_id.id),
                                                                         ('bsg_expirydate', '=', None),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.branch_id', '=', branch_id.id),
                                     ('bsg_expirydate', '=', None),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        grand_total += passport_count
                        if passport_ids:
                            sheet.write(row, col, 'Branch Name', main_heading2)
                            sheet.write_string(row, col + 1, str(branch_id.branch_ar_name), main_heading)
                            sheet.write(row, col+2, 'اسم الفرع', main_heading2)
                            row += 1
                            sheet.write(row, col, 'Employee ID', main_heading2)
                            sheet.write(row, col + 1, 'Employee Name', main_heading2)
                            sheet.write(row, col + 2, 'Department Name', main_heading2)
                            sheet.write(row, col + 3, 'Passport NO', main_heading2)
                            sheet.write(row, col + 4, 'Company Name', main_heading2)
                            sheet.write(row, col + 5, 'Passport Name', main_heading2)
                            sheet.write(row, col + 6, 'Issue Date', main_heading2)
                            sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                            sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                            sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                            sheet.write(row, col + 10, 'Job Position', main_heading2)
                            sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                            sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                            sheet.write(row, col + 13, 'Passport Status', main_heading2)
                            # line removed
                            row += 1
                            sheet.write(row, col, 'هوية الموظف', main_heading2)
                            sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                            sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                            sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                            sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                            sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                            sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                            sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                            sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                            sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                            sheet.write(row, col + 10, 'وظيفه', main_heading2)
                            sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                            sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                            sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                            # line removed
                            row += 1
                            for passport in passport_ids:
                                if passport:
                                    if passport.bsg_issuedate:
                                        issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                        # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                        # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                        issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                    else:
                                        issue_date_hijri_str = None
                                        issue_date_gregorian = None
                                    # unnecessary code removed
                                    if passport.bsg_expirydate:
                                        expiry_date_hijri_str = HijriDate.get_hijri_date(
                                            passport.bsg_expirydate)
                                        # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                        # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                        expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                    else:
                                        expiry_date_hijri_str = None
                                        expiry_date_gregorian = None
                                    sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                       main_heading)
                                    sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                       main_heading)
                                    sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                    sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                    sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                       main_heading)
                                    sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                       main_heading)
                                    sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                       main_heading)
                                    sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    # line removed
                                    row += 1
                            sheet.write(row, col, 'Total', main_heading2)
                            sheet.write_string(row, col + 1, str(passport_count), main_heading)
                            row += 2
                if data.expire_date_condition == 'all':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=',None)])
                        passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.branch_id', '=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.branch_id', '=', None),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                if data.expire_date_condition == 'is_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=',None),
                                                                 ('bsg_expirydate', '=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.branch_id', '=', None),
                                                                         ('bsg_expirydate', '=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.branch_id', '=', None),
                                                                         ('bsg_expirydate', '=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                if data.expire_date_condition == 'is_not_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=', None),
                             ('bsg_expirydate', '!=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '!=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=', None),
                             ('bsg_expirydate', '!=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_before':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '<', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=', None),
                             ('bsg_expirydate', '<', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '<', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=',None),
                             ('bsg_expirydate', '<', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_after':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=',None),
                             ('bsg_expirydate', '>', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=',None),
                                                                 ('bsg_expirydate', '>', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=', None),
                             ('bsg_expirydate', '>', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_after_or_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=', None),
                             ('bsg_expirydate', '>=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=',None),
                                                                 ('bsg_expirydate', '>=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=',None),
                             ('bsg_expirydate', '>=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_before_or_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=', None),
                             ('bsg_expirydate', '<=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=',None),
                                                                 ('bsg_expirydate', '<=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=', None),
                             ('bsg_expirydate', '<=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_between':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.date_from),
                                                                 ('bsg_expirydate', '<', data.date_to)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=',None),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=',None),
                                                                 ('bsg_expirydate', '>', data.date_from),
                                                                 ('bsg_expirydate', '<', data.date_to),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=', None),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_set':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '!=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=', None),
                             ('bsg_expirydate', '!=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=',None),
                                                                 ('bsg_expirydate', '!=', None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=',None),
                             ('bsg_expirydate', '!=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_not_set':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=', None),
                             ('bsg_expirydate', '=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', '=', None),
                                                                 ('bsg_expirydate', '=', None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.branch_id', '=', None),
                             ('bsg_expirydate', '=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                grand_total += passport_count
                if passport_ids:
                    sheet.write(row, col, 'Branch Name', main_heading2)
                    sheet.write_string(row, col + 1, 'Undefined', main_heading)
                    sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                    row += 1
                    sheet.write(row, col, 'Employee ID', main_heading2)
                    sheet.write(row, col + 1, 'Employee Name', main_heading2)
                    sheet.write(row, col + 2, 'Department Name', main_heading2)
                    sheet.write(row, col + 3, 'Passport NO', main_heading2)
                    sheet.write(row, col + 4, 'Company Name', main_heading2)
                    sheet.write(row, col + 5, 'Passport Name', main_heading2)
                    sheet.write(row, col + 6, 'Issue Date', main_heading2)
                    sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                    sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                    sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                    sheet.write(row, col + 10, 'Job Position', main_heading2)
                    sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                    sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                    sheet.write(row, col + 13, 'Passport Status', main_heading2)
                    #line removed
                    row += 1
                    sheet.write(row, col, 'هوية الموظف', main_heading2)
                    sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                    sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                    sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                    sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                    sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                    sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                    sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                    sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                    sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                    sheet.write(row, col + 10, 'وظيفه', main_heading2)
                    sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                    sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                    sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                    # line removed
                    row += 1
                    for passport in passport_ids:
                        if passport:
                            if passport.bsg_issuedate:
                                issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                            else:
                                issue_date_hijri_str = None
                                issue_date_gregorian = None
                           #unnecessary code removed
                            if passport.bsg_expirydate:
                                expiry_date_hijri_str = HijriDate.get_hijri_date(
                                    passport.bsg_expirydate)
                                # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                            else:
                                expiry_date_hijri_str = None
                                expiry_date_gregorian = None
                            sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                               main_heading)
                            sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                               main_heading)
                            sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                               main_heading)
                            sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                               main_heading)
                            sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                               main_heading)
                            sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                               main_heading)
                            sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                            sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                            sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                               main_heading)
                            sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                               main_heading)
                            sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                            sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                               main_heading)
                            sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                               main_heading)
                            sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                               main_heading)
                            #line removed
                            row += 1
                    sheet.write(row, col, 'Total', main_heading2)
                    sheet.write_string(row, col + 1, str(passport_count), main_heading)
                    row += 2
                sheet.write(row, col, 'Grand Total', main_heading2)
                sheet.write_string(row, col + 1, str(grand_total),
                                   main_heading)
            if data.grouping_by == 'by_department':
                department_ids = self.env['hr.department'].search([])
                grand_total = 0
                for department_id in department_ids:
                    if department_id:
                        if data.expire_date_condition == 'all':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','=',department_id.id)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.department_id','=',department_id.id)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','=',department_id.id),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.department_id','=',department_id.id),
                                                                           ('bsg_employee_id.employee_state', '=',data.employee_state)])
                        if data.expire_date_condition == 'is_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','=',department_id.id),
                                                                         ('bsg_expirydate', '=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.department_id','=',department_id.id),
                                                                                 ('bsg_expirydate', '=',data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','=',department_id.id),
                                                                         ('bsg_expirydate', '=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.department_id','=',department_id.id),
                                                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_not_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '!=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '!=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '!=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_before':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '<', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '<', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '<', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '<', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_after':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '>', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '>', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '>', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '>', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_after_or_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '>=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '>=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '>=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_before_or_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '<=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '<=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '<=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_between':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '>', data.date_from),
                                     ('bsg_expirydate', '<', data.date_to)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '>', data.date_from),
                                     ('bsg_expirydate', '<', data.date_to),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_set':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '!=', None)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '!=', None)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '!=', None),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '!=', None),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_not_set':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '=', None)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '=', None)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', department_id.id),
                                                                         ('bsg_expirydate', '=', None),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.department_id', '=', department_id.id),
                                     ('bsg_expirydate', '=', None),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        grand_total += passport_count
                        if passport_ids:
                            sheet.write(row, col, 'Department Name', main_heading2)
                            sheet.write_string(row, col + 1, str(department_id.complete_name), main_heading)
                            sheet.write(row, col+1, 'اسم القسم', main_heading2)
                            row += 1
                            sheet.write(row, col, 'Employee ID', main_heading2)
                            sheet.write(row, col + 1, 'Employee Name', main_heading2)
                            sheet.write(row, col + 2, 'Branch Name', main_heading2)
                            sheet.write(row, col + 3, 'Passport NO', main_heading2)
                            sheet.write(row, col + 4, 'Company Name', main_heading2)
                            sheet.write(row, col + 5, 'Passport Name', main_heading2)
                            sheet.write(row, col + 6, 'Issue Date', main_heading2)
                            sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                            sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                            sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                            sheet.write(row, col + 10, 'Job Position', main_heading2)
                            sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                            sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                            sheet.write(row, col + 13, 'Passport Status', main_heading2)
                            #line removed
                            row += 1
                            sheet.write(row, col, 'هوية الموظف', main_heading2)
                            sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                            sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                            sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                            sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                            sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                            sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                            sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                            sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                            sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                            sheet.write(row, col + 10, 'وظيفه', main_heading2)
                            sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                            sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                            sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                            # line removed
                            row += 1
                            for passport in passport_ids:
                                if passport:
                                    if passport.bsg_issuedate:
                                        issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                        # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                        # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                        issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                    else:
                                        issue_date_hijri_str = None
                                        issue_date_gregorian = None
                                   #unnecessary code removed
                                    if passport.bsg_expirydate:
                                        expiry_date_hijri_str = HijriDate.get_hijri_date(
                                            passport.bsg_expirydate)
                                        # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                        # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                        expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                    else:
                                        expiry_date_hijri_str = None
                                        expiry_date_gregorian = None
                                    sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                       main_heading)
                                    sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 2, str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                       main_heading)
                                    sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                    sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                    sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                       main_heading)
                                    sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                       main_heading)
                                    sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                    sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                       main_heading)
                                    sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    #line removed
                                    row += 1
                            sheet.write(row, col, 'Total', main_heading2)
                            sheet.write_string(row, col + 1, str(passport_count), main_heading)
                            row += 2
                if data.expire_date_condition == 'all':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=',None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=',None),
                             ('bsg_expirydate', '=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_not_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '!=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '!=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '!=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_before':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '<', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '<', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '<', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '<', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_after':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '>', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '>', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_after_or_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '>=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '>=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '>=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_before_or_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '<=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=',None),
                                                                 ('bsg_expirydate', '<=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '<=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_between':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=',None),
                                                                 ('bsg_expirydate', '>', data.date_from),
                                                                 ('bsg_expirydate', '<', data.date_to)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.date_from),
                                                                 ('bsg_expirydate', '<', data.date_to),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_set':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '!=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '!=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '!=', None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '!=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_not_set':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', '=', None),
                                                                 ('bsg_expirydate', '=', None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.department_id', '=', None),
                             ('bsg_expirydate', '=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                grand_total += passport_count
                if passport_ids:
                    sheet.write(row, col, 'Department Name', main_heading2)
                    sheet.write_string(row, col + 1, 'Undefined', main_heading)
                    sheet.write(row, col + 1, 'اسم القسم', main_heading2)
                    row += 1
                    sheet.write(row, col, 'Employee ID', main_heading2)
                    sheet.write(row, col + 1, 'Employee Name', main_heading2)
                    sheet.write(row, col + 2, 'Branch Name', main_heading2)
                    sheet.write(row, col + 3, 'Passport NO', main_heading2)
                    sheet.write(row, col + 4, 'Company Name', main_heading2)
                    sheet.write(row, col + 5, 'Passport Name', main_heading2)
                    sheet.write(row, col + 6, 'Issue Date', main_heading2)
                    sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                    sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                    sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                    sheet.write(row, col + 10, 'Job Position', main_heading2)
                    sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                    sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                    sheet.write(row, col + 13, 'Passport Status', main_heading2)
                    #line removed
                    row += 1
                    sheet.write(row, col, 'هوية الموظف', main_heading2)
                    sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                    sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                    sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                    sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                    sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                    sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                    sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                    sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                    sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                    sheet.write(row, col + 10, 'وظيفه', main_heading2)
                    sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                    sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                    sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                    # line removed
                    row += 1
                    for passport in passport_ids:
                        if passport:
                            if passport.bsg_issuedate:
                                issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                            else:
                                issue_date_hijri_str = None
                                issue_date_gregorian = None
                           #unnecessary code removed
                            if passport.bsg_expirydate:
                                expiry_date_hijri_str = HijriDate.get_hijri_date(
                                    passport.bsg_expirydate)
                                # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                            else:
                                expiry_date_hijri_str = None
                                expiry_date_gregorian = None
                            sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                               main_heading)
                            sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                               main_heading)
                            sheet.write_string(row, col + 2, str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                               main_heading)
                            sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                               main_heading)
                            sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                               main_heading)
                            sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                               main_heading)
                            sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                            sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                            sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                               main_heading)
                            sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                               main_heading)
                            sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                            sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                               main_heading)
                            sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                               main_heading)
                            sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                               main_heading)
                            #line removed
                            row += 1
                    sheet.write(row, col, 'Total', main_heading2)
                    sheet.write_string(row, col + 1, str(passport_count), main_heading)
                    row += 2
                sheet.write(row, col, 'Grand Total', main_heading2)
                sheet.write_string(row, col + 1, str(grand_total),main_heading)
            if data.grouping_by == 'by_company':
                company_ids = self.env['res.company'].search([])
                grand_total = 0
                for company_id in company_ids:
                    if company_id:
                        if data.expire_date_condition == 'all':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','=',company_id.id)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.company_id','=',company_id.id)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','=',company_id.id),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.company_id','=',company_id.id),
                                                                           ('bsg_employee_id.employee_state', '=',data.employee_state)])
                        if data.expire_date_condition == 'is_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','=',company_id.id),
                                                                         ('bsg_expirydate', '=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.company_id','=',company_id.id),
                                                                                 ('bsg_expirydate', '=',data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','=',company_id.id),
                                                                         ('bsg_expirydate', '=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.company_id','=',company_id.id),
                                                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_not_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '!=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '!=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '!=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_before':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '<', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '<', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '<', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '<', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_after':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '>', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '>', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '>', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '>', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_after_or_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '>=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '>=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '>=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_before_or_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '<=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '<=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '<=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_between':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '>', data.date_from),
                                     ('bsg_expirydate', '<', data.date_to)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '>', data.date_from),
                                     ('bsg_expirydate', '<', data.date_to),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_set':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '!=', None)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '!=', None)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '!=', None),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '!=', None),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_not_set':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '=', None)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '=', None)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', company_id.id),
                                                                         ('bsg_expirydate', '=', None),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.company_id', '=', company_id.id),
                                     ('bsg_expirydate', '=', None),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        grand_total += passport_count
                        if passport_ids:
                            sheet.write(row, col, 'Company Name', main_heading2)
                            sheet.write_string(row, col + 1, str(company_id.name), main_heading)
                            sheet.write(row, col+2, 'اسم الشركة', main_heading2)
                            row += 1
                            sheet.write(row, col, 'Employee ID', main_heading2)
                            sheet.write(row, col + 1, 'Employee Name', main_heading2)
                            sheet.write(row, col + 2, 'Branch Name', main_heading2)
                            sheet.write(row, col + 3, 'Passport NO', main_heading2)
                            sheet.write(row, col + 4, 'Department Name', main_heading2)
                            sheet.write(row, col + 5, 'Passport Name', main_heading2)
                            sheet.write(row, col + 6, 'Issue Date', main_heading2)
                            sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                            sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                            sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                            sheet.write(row, col + 10, 'Job Position', main_heading2)
                            sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                            sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                            sheet.write(row, col + 13, 'Passport Status', main_heading2)
                            #line removed
                            row += 1
                            sheet.write(row, col, 'هوية الموظف', main_heading2)
                            sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                            sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                            sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                            sheet.write(row, col + 4, 'اسم القسم', main_heading2)
                            sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                            sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                            sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                            sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                            sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                            sheet.write(row, col + 10, 'وظيفه', main_heading2)
                            sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                            sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                            sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                            # line removed
                            row += 1
                            for passport in passport_ids:
                                if passport:
                                    if passport.bsg_issuedate:
                                        issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                        # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                        # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                        issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                    else:
                                        issue_date_hijri_str = None
                                        issue_date_gregorian = None
                                   #unnecessary code removed
                                    if passport.bsg_expirydate:
                                        expiry_date_hijri_str = HijriDate.get_hijri_date(
                                            passport.bsg_expirydate)
                                        # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                        # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                        expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                    else:
                                        expiry_date_hijri_str = None
                                        expiry_date_gregorian = None
                                    sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                       main_heading)
                                    sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 2,
                                                       str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                       main_heading)
                                    sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                    sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                    sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                       main_heading)
                                    sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                       main_heading)
                                    sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                    sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                       main_heading)
                                    sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    #line removed
                                    row += 1
                            sheet.write(row, col, 'Total', main_heading2)
                            sheet.write_string(row, col + 1, str(passport_count), main_heading)
                            row += 2
                if data.expire_date_condition == 'all':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_not_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '!=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '!=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '!=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_before':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '<', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '<', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '<', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '<', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_after':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '>', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '>', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_after_or_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '>=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '>=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '>=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_before_or_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '<=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '<=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '<=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_between':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.date_from),
                                                                 ('bsg_expirydate', '<', data.date_to)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.date_from),
                                                                 ('bsg_expirydate', '<', data.date_to),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_set':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '!=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '!=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '!=', None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '!=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_not_set':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', '=', None),
                                                                 ('bsg_expirydate', '=', None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.company_id', '=', None),
                             ('bsg_expirydate', '=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Company Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'اسم الشركة', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Branch Name', main_heading2)
                        sheet.write(row, col + 3, 'Passport NO', main_heading2)
                        sheet.write(row, col + 4, 'Department Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 4, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                sheet.write(row, col, 'Grand Total', main_heading2)
                sheet.write_string(row, col + 1, str(grand_total),main_heading)
            if data.grouping_by == 'by_employee_tag':
                category_ids = self.env['hr.employee.category'].search([])
                employee_ids = self.env['hr.employee'].search([])
                grand_total = 0
                for category_id in category_ids:
                    if category_id:
                        passport_list=[]
                        total=0
                        for employee_id in employee_ids:
                            if employee_id:
                                if category_id in employee_id.category_ids:
                                    if data.expire_date_condition == 'all':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if category_id in passport.bsg_employee_id.category_ids:
                                                        passport_list.append(passport)
                                    if data.expire_date_condition == 'is_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if category_id in passport.bsg_employee_id.category_ids:
                                                        passport_list.append(passport)
                                    if data.expire_date_condition == 'is_not_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '!=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '!=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=',
                                                  data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if category_id in passport.bsg_employee_id.category_ids:
                                                        passport_list.append(passport)
                                    if data.expire_date_condition == 'is_before':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '<', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '<', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=',
                                                  data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if category_id in passport.bsg_employee_id.category_ids:
                                                        passport_list.append(passport)
                                    if data.expire_date_condition == 'is_after':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '>', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '>', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=',
                                                  data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if category_id in passport.bsg_employee_id.category_ids:
                                                        passport_list.append(passport)
                                    if data.expire_date_condition == 'is_after_or_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '>=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '>=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=',
                                                  data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if category_id in passport.bsg_employee_id.category_ids:
                                                        passport_list.append(passport)
                                    if data.expire_date_condition == 'is_before_or_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '<=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '<=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=',
                                                  data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if category_id in passport.bsg_employee_id.category_ids:
                                                        passport_list.append(passport)
                                    if data.expire_date_condition == 'is_between':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '>', data.date_from),
                                                 ('bsg_expirydate', '<', data.date_to)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '>', data.date_from),
                                                 ('bsg_expirydate', '<', data.date_to),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if category_id in passport.bsg_employee_id.category_ids:
                                                        passport_list.append(passport)
                                    if data.expire_date_condition == 'is_set':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '!=', None)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '!=', None),
                                                 ('bsg_employee_id.employee_state', '=',
                                                  data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if category_id in passport.bsg_employee_id.category_ids:
                                                        passport_list.append(passport)
                                    if data.expire_date_condition == 'is_not_set':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '=', None)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id', '=', employee_id.id),
                                                 ('bsg_expirydate', '=', None),
                                                 ('bsg_employee_id.employee_state', '=',
                                                  data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if category_id in passport.bsg_employee_id.category_ids:
                                                        passport_list.append(passport)
                        if passport_list:
                            sheet.write(row, col, 'Employee Tag', main_heading2)
                            sheet.write_string(row, col + 1, str(category_id.name), main_heading)
                            sheet.write(row, col + 2, 'علامة الموظف', main_heading2)
                            row += 1
                            sheet.write(row, col, 'Employee ID', main_heading2)
                            sheet.write(row, col + 1, 'Employee Name', main_heading2)
                            sheet.write(row, col + 2, 'Department Name', main_heading2)
                            sheet.write(row, col + 3, 'Branch Name', main_heading2)
                            sheet.write(row, col + 4, 'Company Name', main_heading2)
                            sheet.write(row, col + 5, 'Passport NO', main_heading2)
                            sheet.write(row, col + 6, 'Passport Name', main_heading2)
                            sheet.write(row, col + 7, 'Issue Date', main_heading2)
                            sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                            sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                            sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                            sheet.write(row, col + 11, 'Job Position', main_heading2)
                            sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                            sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                            sheet.write(row, col + 14, 'Passport Status', main_heading2)
                            #line removed
                            row += 1
                            sheet.write(row, col, 'هوية الموظف', main_heading2)
                            sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                            sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                            sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                            sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                            sheet.write(row, col + 5, ' رقم جواز السفر', main_heading2)
                            sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                            sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                            sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                            sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                            sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                            sheet.write(row, col + 11, 'وظيفه', main_heading2)
                            sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                            sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                            sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                            # line removed
                            row += 1
                            total = len(passport_list)
                            grand_total+=total
                            for passport in passport_list:
                                if passport:
                                    if passport.bsg_issuedate:
                                        issue_date_hijri_str = HijriDate.get_hijri_date(
                                            passport.bsg_issuedate)
                                        # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                        # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                        issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                    else:
                                        issue_date_hijri_str = None
                                        issue_date_gregorian = None                            
                                    if passport.bsg_expirydate:
                                        expiry_date_hijri_str = HijriDate.get_hijri_date(
                                            passport.bsg_expirydate)
                                        # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                        # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                        expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                            "%m/%d/%Y")
                                    else:
                                        expiry_date_hijri_str = None
                                        expiry_date_gregorian = None
                                    sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                       main_heading)
                                    sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                       main_heading)
                                    sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 3, str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                       main_heading)
                                    sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                    sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                    sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                       main_heading)
                                    sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                       main_heading)
                                    sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                    sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                       main_heading)
                                    sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    #line removed
                                    row += 1
                            sheet.write(row, col, 'Total', main_heading2)
                            sheet.write_string(row, col + 1, str(total), main_heading)
                            row += 2
                if data.expire_date_condition == 'all':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=',False)])
                    else:
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_not_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '!=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '!=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '!=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=',
                              data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '!=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_before':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '<', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '<', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '<', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=',
                              data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '<', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_after':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=',False),
                             ('bsg_expirydate', '>', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=',False),
                             ('bsg_expirydate', '>', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '>', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=',
                              data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '>', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_after_or_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '>=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '>=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '>=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=',
                              data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '>=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_before_or_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '<=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '<=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=',False),
                             ('bsg_expirydate', '<=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=',
                              data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=',False),
                             ('bsg_expirydate', '<=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_between':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=',False),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to)])
                    else:
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_set':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '!=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '!=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '!=', None),
                             ('bsg_employee_id.employee_state', '=',
                              data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '!=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_not_set':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=',False),
                             ('bsg_expirydate', '=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=',False),
                             ('bsg_expirydate', '=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '=', None),
                             ('bsg_employee_id.employee_state', '=',
                              data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.category_ids', '=', False),
                             ('bsg_expirydate', '=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                grand_total += passport_count
                total += passport_count
                if passport_ids:
                    sheet.write(row, col, 'Employee Tag', main_heading2)
                    sheet.write_string(row, col + 1, 'Undefined', main_heading)
                    sheet.write(row, col + 2, 'علامة الموظف', main_heading2)
                    row += 1
                    sheet.write(row, col, 'Employee ID', main_heading2)
                    sheet.write(row, col + 1, 'Employee Name', main_heading2)
                    sheet.write(row, col + 2, 'Department Name', main_heading2)
                    sheet.write(row, col + 3, 'Branch Name', main_heading2)
                    sheet.write(row, col + 4, 'Company Name', main_heading2)
                    sheet.write(row, col + 5, 'Passport NO', main_heading2)
                    sheet.write(row, col + 6, 'Passport Name', main_heading2)
                    sheet.write(row, col + 7, 'Issue Date', main_heading2)
                    sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                    sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                    sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                    sheet.write(row, col + 11, 'Job Position', main_heading2)
                    sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                    sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                    sheet.write(row, col + 14, 'Passport Status', main_heading2)
                    #line removed
                    row += 1
                    sheet.write(row, col, 'هوية الموظف', main_heading2)
                    sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                    sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                    sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                    sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                    sheet.write(row, col + 5, ' رقم جواز السفر', main_heading2)
                    sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                    sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                    sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                    sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                    sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                    sheet.write(row, col + 11, 'وظيفه', main_heading2)
                    sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                    sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                    sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                    # line removed
                    row += 1
                    for passport in passport_ids:
                        if passport:
                            if passport.bsg_issuedate:
                                issue_date_hijri_str = HijriDate.get_hijri_date(
                                    passport.bsg_issuedate)
                                # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                            else:
                                issue_date_hijri_str = None
                                issue_date_gregorian = None
                            #Unnecessary code removed
                            if passport.bsg_expirydate:
                                expiry_date_hijri_str = HijriDate.get_hijri_date(
                                    passport.bsg_expirydate)
                                # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                    "%m/%d/%Y")
                            else:
                                expiry_date_hijri_str = None
                                expiry_date_gregorian = None
                            sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                               main_heading)
                            sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                               main_heading)
                            sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                               main_heading)
                            sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                               main_heading)
                            sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                               main_heading)
                            sheet.write_string(row, col + 3, str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                               main_heading)
                            sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                               main_heading)
                            sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                               main_heading)
                            sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                               main_heading)
                            sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                            sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                            sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                               main_heading)
                            sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                               main_heading)
                            sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                            sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                               main_heading)
                            sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                               main_heading)
                            sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                               main_heading)
                            #line removed
                            row += 1
                    sheet.write(row, col, 'Total', main_heading2)
                    sheet.write_string(row, col + 1, str(passport_count), main_heading)
                    row += 2
                sheet.write(row, col, 'Grand Total', main_heading2)
                sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_job_position':
                job_ids = self.env['hr.job'].search([])
                grand_total = 0
                for job_id in job_ids:
                    if job_id:
                        if data.expire_date_condition == 'all':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.job_id','=',job_id.id)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.job_id','=',job_id.id),
                                                                           ('bsg_employee_id.employee_state', '=',data.employee_state)])
                        if data.expire_date_condition == 'is_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count([('bsg_employee_id.job_id','=',job_id.id),
                                                                                 ('bsg_expirydate', '=',data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', job_id.id),
                                                                         ('bsg_expirydate', '=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id', '=', job_id.id),
                                     ('bsg_expirydate', '=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_not_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '!=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '!=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '!=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '!=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_before':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '<', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '<', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '<', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '<', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_after':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '>', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '>', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '>', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '>', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_after_or_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '>=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '>=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '>=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_before_or_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '<=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '<=', data.expiry_date),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '<=', data.expiry_date),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_between':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '>', data.date_from),
                                     ('bsg_expirydate', '<', data.date_to)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '>', data.date_from),
                                     ('bsg_expirydate', '<', data.date_to),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_set':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '!=', None)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '!=', None)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '!=', None),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '!=', None),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if data.expire_date_condition == 'is_not_set':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '=', None)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '=', None)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id','=',job_id.id),
                                                                         ('bsg_expirydate', '=', None),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state)])
                                passport_count = self.env['hr.passport'].search_count(
                                    [('bsg_employee_id.job_id','=',job_id.id),
                                     ('bsg_expirydate', '=', None),
                                     ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        grand_total += passport_count
                        if passport_ids:
                            sheet.write(row, col, 'Job Position', main_heading2)
                            sheet.write_string(row, col + 1, str(job_id.name), main_heading)
                            sheet.write(row, col+2, 'وظيفه', main_heading2)
                            row += 1
                            sheet.write(row, col, 'Employee ID', main_heading2)
                            sheet.write(row, col + 1, 'Employee Name', main_heading2)
                            sheet.write(row, col + 2, 'Branch Name', main_heading2)
                            sheet.write(row, col + 3, 'Department Name', main_heading2)
                            sheet.write(row, col + 4, 'Passport NO', main_heading2)
                            sheet.write(row, col + 5, 'Company Name', main_heading2)
                            sheet.write(row, col + 6, 'Passport Name', main_heading2)
                            sheet.write(row, col + 7, 'Issue Date', main_heading2)
                            sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                            sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                            sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                            sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                            sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                            sheet.write(row, col + 13, 'Passport Status', main_heading2)
                            #line removed
                            row += 1
                            sheet.write(row, col, 'هوية الموظف', main_heading2)
                            sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                            sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                            sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                            sheet.write(row, col + 4, ' رقم جواز السفر', main_heading2)
                            sheet.write(row, col + 5, 'اسم الشركة', main_heading2)
                            sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                            sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                            sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                            sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                            sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                            sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                            sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                            sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                            # line removed
                            row += 1
                            for passport in passport_ids:
                                if passport:
                                    if passport.bsg_issuedate:
                                        issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                        # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                        # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                        issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                    else:
                                        issue_date_hijri_str = None
                                        issue_date_gregorian = None
                                   #unnecessary code removed
                                    if passport.bsg_expirydate:
                                        expiry_date_hijri_str = HijriDate.get_hijri_date(
                                            passport.bsg_expirydate)
                                        # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                        # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                        expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                    else:
                                        expiry_date_hijri_str = None
                                        expiry_date_gregorian = None
                                    sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                       main_heading)
                                    sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 2,
                                                       str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 4, str(passport.bsg_passport_number),
                                                       main_heading)
                                    sheet.write_string(row, col + 5, str(passport.bsg_employee_id.company_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                    sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                    sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                       main_heading)
                                    sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                       main_heading)
                                    sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                       main_heading)
                                    sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    #line removed
                                    row += 1
                            sheet.write(row, col, 'Total', main_heading2)
                            sheet.write_string(row, col + 1, str(passport_count), main_heading)
                            row += 2
                if data.expire_date_condition == 'all':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=',None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=',None),
                             ('bsg_expirydate', '=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_not_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '!=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '!=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '!=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_before':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '<', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '<', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '<', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '<', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_after':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '>', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '>', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_after_or_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '>=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '>=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '>=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_before_or_equal_to':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '<=', data.expiry_date)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=',None),
                                                                 ('bsg_expirydate', '<=', data.expiry_date),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '<=', data.expiry_date),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_between':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=',None),
                                                                 ('bsg_expirydate', '>', data.date_from),
                                                                 ('bsg_expirydate', '<', data.date_to)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '>', data.date_from),
                                                                 ('bsg_expirydate', '<', data.date_to),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '>', data.date_from),
                             ('bsg_expirydate', '<', data.date_to),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_set':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '!=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '!=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '!=', None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '!=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                if data.expire_date_condition == 'is_not_set':
                    if data.employee_state == 'all':
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '=', None)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '=', None)])
                    else:
                        passport_ids = self.env['hr.passport'].search([('bsg_employee_id.job_id', '=', None),
                                                                 ('bsg_expirydate', '=', None),
                                                                 ('bsg_employee_id.employee_state', '=',
                                                                  data.employee_state)])
                        passport_count = self.env['hr.passport'].search_count(
                            [('bsg_employee_id.job_id', '=', None),
                             ('bsg_expirydate', '=', None),
                             ('bsg_employee_id.employee_state', '=', data.employee_state)])
                grand_total += passport_count
                if passport_ids:
                    sheet.write(row, col, 'Job Position', main_heading2)
                    sheet.write_string(row, col + 1, 'Undefined', main_heading)
                    sheet.write(row, col + 2, 'وظيفه', main_heading2)
                    row += 1
                    sheet.write(row, col, 'Employee ID', main_heading2)
                    sheet.write(row, col + 1, 'Employee Name', main_heading2)
                    sheet.write(row, col + 2, 'Branch Name', main_heading2)
                    sheet.write(row, col + 3, 'Department Name', main_heading2)
                    sheet.write(row, col + 4, 'Passport NO', main_heading2)
                    sheet.write(row, col + 5, 'Company Name', main_heading2)
                    sheet.write(row, col + 6, 'Passport Name', main_heading2)
                    sheet.write(row, col + 7, 'Issue Date', main_heading2)
                    sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                    sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                    sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                    sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                    sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                    sheet.write(row, col + 13, 'Passport Status', main_heading2)
                    #line removed
                    row += 1
                    sheet.write(row, col, 'هوية الموظف', main_heading2)
                    sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                    sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                    sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                    sheet.write(row, col + 4, ' رقم جواز السفر', main_heading2)
                    sheet.write(row, col + 5, 'اسم الشركة', main_heading2)
                    sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                    sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                    sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                    sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                    sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                    sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                    sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                    sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                    # line removed
                    row += 1
                    for passport in passport_ids:
                        if passport:
                            if passport.bsg_issuedate:
                                issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                            else:
                                issue_date_hijri_str = None
                                issue_date_gregorian = None
                           #unnecessary code removed
                            if passport.bsg_expirydate:
                                expiry_date_hijri_str = HijriDate.get_hijri_date(
                                    passport.bsg_expirydate)
                                # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                            else:
                                expiry_date_hijri_str = None
                                expiry_date_gregorian = None
                            sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                               main_heading)
                            sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                               main_heading)
                            sheet.write_string(row, col + 2,
                                               str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                               main_heading)
                            sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                               main_heading)
                            sheet.write_string(row, col + 4, str(passport.bsg_passport_number),
                                               main_heading)
                            sheet.write_string(row, col + 5, str(passport.bsg_employee_id.company_id.name),
                                               main_heading)
                            sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                               main_heading)
                            sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                            sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                            sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                               main_heading)
                            sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                               main_heading)
                            sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                               main_heading)
                            sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                               main_heading)
                            sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                               main_heading)
                            #line removed
                            row += 1
                    sheet.write(row, col, 'Total', main_heading2)
                    sheet.write_string(row, col + 1, str(passport_count), main_heading)
                    row += 2
                sheet.write(row, col, 'Grand Total', main_heading2)
                sheet.write_string(row, col + 1, str(grand_total),main_heading)
        if data.mode == 'by_branch':
            if data.grouping_by == 'all':
                sheet.write(row, col, 'Employee ID', main_heading2)
                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                sheet.write(row, col + 2, 'Department Name', main_heading2)
                sheet.write(row, col + 3, 'Branch Name', main_heading2)
                sheet.write(row, col + 4, 'Company Name', main_heading2)
                sheet.write(row, col + 5, 'Passport NO', main_heading2)
                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                sheet.write(row, col + 11, 'Job Position', main_heading2)
                sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                sheet.write(row, col + 14, 'Passport Status', main_heading2)
                #line removed
                row += 1
                sheet.write(row, col, 'هوية الموظف', main_heading2)
                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                sheet.write(row, col + 5, 'رقم جواز السفر', main_heading2)
                sheet.write(row, col + 6, 'اسم جواز السفر', main_heading2)
                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                sheet.write(row, col + 11, 'وظيفه', main_heading2)
                sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                # line removed
                row += 1
                if data.branches:
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                     ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                     ('bsg_employee_id.employee_state', '=', data.employee_state),
                                                                     ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                        ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                        ('bsg_employee_id.employee_state', '=',data.employee_state),
                                                                        ('bsg_expirydate', '!=', data.expiry_date)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                        ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                        ('bsg_employee_id.employee_state', '=',data.employee_state),
                                                                        ('bsg_expirydate', '>', data.expiry_date)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                        ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state),
                                                                         ('bsg_expirydate', '<', data.expiry_date)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                        ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                        ('bsg_employee_id.employee_state', '=',data.employee_state),
                                                                         ('bsg_expirydate', '>=', data.expiry_date)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                         ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state),
                                                                         ('bsg_expirydate', '<=', data.expiry_date)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                         ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state),
                                                                         ('bsg_expirydate', '!=', None)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                         ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id','in',data.branches.ids),
                                                                         ('bsg_employee_id.employee_state', '=',data.employee_state),
                                                                         ('bsg_expirydate', '=', None)])
                    if passport_ids:
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
            if data.grouping_by == 'by_branch':
                if data.branches:
                    grand_total=0
                    for branch_id in data.branches:
                        if branch_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                            grand_total+=passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Branch Name', main_heading2)
                                sheet.write_string(row, col + 1, str(branch_id.branch_ar_name), main_heading)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Department Name', main_heading2)
                                sheet.write(row, col + 3, 'Passport NO', main_heading2)
                                sheet.write(row, col + 4, 'Company Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                 ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Branch Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Department Name', main_heading2)
                        sheet.write(row, col + 3, 'Passport NO', main_heading2)
                        sheet.write(row, col + 4, 'Company Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_department':
                if data.branches:
                    department_ids = self.env['hr.department'].search([])
                    grand_total=0
                    for department_id in department_ids:
                        if department_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                            grand_total+=passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Department Name', main_heading2)
                                sheet.write_string(row, col + 1, str(department_id.complete_name), main_heading)
                                sheet.write(row, col + 1, 'اسم القسم', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Branch Name', main_heading2)
                                sheet.write(row, col + 3, 'Passport NO', main_heading2)
                                sheet.write(row, col + 4, 'Company Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=',None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=',None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=',None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Department Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 1, 'اسم القسم', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Branch Name', main_heading2)
                        sheet.write(row, col + 3, 'Passport NO', main_heading2)
                        sheet.write(row, col + 4, 'Company Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_company':
                if data.branches:
                    company_ids = self.env['res.company'].search([])
                    grand_total = 0
                    for company_id in company_ids:
                        if company_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                            grand_total += passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Company Name', main_heading2)
                                sheet.write_string(row, col + 1, str(company_id.name), main_heading)
                                sheet.write(row, col + 2, 'اسم الشركة', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Branch Name', main_heading2)
                                sheet.write(row, col + 3, 'Passport NO', main_heading2)
                                sheet.write(row, col + 4, 'Department Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 4, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Company Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'اسم الشركة', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Branch Name', main_heading2)
                        sheet.write(row, col + 3, 'Passport NO', main_heading2)
                        sheet.write(row, col + 4, 'Department Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 4, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col+ 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_employee_tag':
                if data.branches:
                    category_ids = self.env['hr.employee.category'].search([])
                    grand_total = 0
                    for category_id in category_ids:
                        if category_id:
                            passport_list=[]
                            total = 0
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', 'in', data.branches.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', 'in', data.branches.ids),('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                                                             ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                                                             ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                                                             ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                                                             ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                                                             ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                                                             ('bsg_expirydate', '>', data.date_from),
                                                                             ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                                                             ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                                                             ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if passport_list:
                                sheet.write(row, col, 'Employee Tag', main_heading2)
                                sheet.write_string(row, col + 1, str(category_id.name), main_heading)
                                sheet.write(row, col + 2, 'علامة الموظف', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Department Name', main_heading2)
                                sheet.write(row, col + 3, 'Branch Name', main_heading2)
                                sheet.write(row, col + 4, 'Company Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport NO', main_heading2)
                                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 11, 'Job Position', main_heading2)
                                sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 14, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 5, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 11, 'وظيفه', main_heading2)
                                sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_list:
                                    if passport:
                                        total += 1
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                        #Unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                grand_total += total
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(total), main_heading)
                                row += 2
                    total = 0
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.category_ids', '=',False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_expirydate', '=', data.expiry_date),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                        if passport_ids:
                            sheet.write(row, col, 'Employee Tag', main_heading2)
                            sheet.write_string(row, col + 1, 'Undefined', main_heading)
                            sheet.write(row, col + 2, 'علامة الموظف', main_heading2)
                            row += 1
                            sheet.write(row, col, 'Employee ID', main_heading2)
                            sheet.write(row, col + 1, 'Employee Name', main_heading2)
                            sheet.write(row, col + 2, 'Department Name', main_heading2)
                            sheet.write(row, col + 3, 'Branch Name', main_heading2)
                            sheet.write(row, col + 4, 'Company Name', main_heading2)
                            sheet.write(row, col + 5, 'Passport NO', main_heading2)
                            sheet.write(row, col + 6, 'Passport Name', main_heading2)
                            sheet.write(row, col + 7, 'Issue Date', main_heading2)
                            sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                            sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                            sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                            sheet.write(row, col + 11, 'Job Position', main_heading2)
                            sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                            sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                            sheet.write(row, col + 14, 'Passport Status', main_heading2)
                            #line removed
                            row += 1
                            sheet.write(row, col, 'هوية الموظف', main_heading2)
                            sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                            sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                            sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                            sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                            sheet.write(row, col + 5, ' رقم جواز السفر', main_heading2)
                            sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                            sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                            sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                            sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                            sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                            sheet.write(row, col + 11, 'وظيفه', main_heading2)
                            sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                            sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                            sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                            # line removed
                            row += 1
                            for passport in passport_ids:
                                if passport:
                                    total += 1
                                    if passport.bsg_issuedate:
                                        issue_date_hijri_str = HijriDate.get_hijri_date(
                                            passport.bsg_issuedate)
                                        # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                        # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                        issue_date_gregorian = passport.bsg_issuedate.strftime(
                                            "%m/%d/%Y")
                                    else:
                                        issue_date_hijri_str = None
                                        issue_date_gregorian = None
                                    #Unnecessary code removed
                                    if passport.bsg_expirydate:
                                        expiry_date_hijri_str = HijriDate.get_hijri_date(
                                            passport.bsg_expirydate)
                                        # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                        # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                        expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                            "%m/%d/%Y")
                                    else:
                                        expiry_date_hijri_str = None
                                        expiry_date_gregorian = None
                                    sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                       main_heading)
                                    sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                       main_heading)
                                    sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 3,
                                                       str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                       main_heading)
                                    sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                       main_heading)
                                    sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                       main_heading)
                                    sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                    sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                    sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                       main_heading)
                                    sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                       main_heading)
                                    sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                    sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                       main_heading)
                                    sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                       main_heading)
                                    #line removed
                                    row += 1
                            grand_total += total
                            sheet.write(row, col, 'Total', main_heading2)
                            sheet.write_string(row, col + 1, str(total), main_heading)
                            row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_job_position':
                if data.branches:
                    job_ids = self.env['hr.job'].search([])
                    grand_total=0
                    for job_id in job_ids:
                        if job_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                            grand_total+=passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Job Position', main_heading2)
                                sheet.write_string(row, col + 1, str(job_id.name), main_heading)
                                sheet.write(row, col + 2, 'وظيفه', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Branch Name', main_heading2)
                                sheet.write(row, col + 3, 'Department Name', main_heading2)
                                sheet.write(row, col + 4, 'Passport NO', main_heading2)
                                sheet.write(row, col + 5, 'Company Name', main_heading2)
                                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 4, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 5, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=',None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=',None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=',None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Job Position', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'وظيفه', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Branch Name', main_heading2)
                        sheet.write(row, col + 3, 'Department Name', main_heading2)
                        sheet.write(row, col + 4, 'Passport NO', main_heading2)
                        sheet.write(row, col + 5, 'Company Name', main_heading2)
                        sheet.write(row, col + 6, 'Passport Name', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date', main_heading2)
                        sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 4, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 5, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
        if data.mode == 'by_department':
            if data.grouping_by == 'all':
                sheet.write(row, col, 'Employee ID', main_heading2)
                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                sheet.write(row, col + 2, 'Department Name', main_heading2)
                sheet.write(row, col + 3, 'Branch Name', main_heading2)
                sheet.write(row, col + 4, 'Company Name', main_heading2)
                sheet.write(row, col + 5, 'Passport NO', main_heading2)
                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                sheet.write(row, col + 11, 'Job Position', main_heading2)
                sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                sheet.write(row, col + 14, 'Passport Status', main_heading2)
                #line removed
                row += 1
                sheet.write(row, col, 'هوية الموظف', main_heading2)
                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                sheet.write(row, col + 5, 'رقم جواز السفر', main_heading2)
                sheet.write(row, col + 6, 'اسم جواز السفر', main_heading2)
                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                sheet.write(row, col + 11, 'وظيفه', main_heading2)
                sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                # line removed
                row += 1
                if data.department:
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                     ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                     ('bsg_employee_id.employee_state', '=', data.employee_state),
                                                                     ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_expirydate', '!=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state),
                                                                         ('bsg_expirydate', '!=', data.expiry_date)])
                    if data.expire_date_condition == 'is_after':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_expirydate', '>', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state),
                                                                         ('bsg_expirydate', '>', data.expiry_date)])
                    if data.expire_date_condition == 'is_before':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_expirydate', '<', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state),
                                                                         ('bsg_expirydate', '<', data.expiry_date)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_expirydate', '>=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state),
                                                                         ('bsg_expirydate', '>=', data.expiry_date)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_expirydate', '<=', data.expiry_date)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state),
                                                                         ('bsg_expirydate', '<=', data.expiry_date)])
                    if data.expire_date_condition == 'is_between':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state),
                                                                         ('bsg_expirydate', '>', data.date_from),
                                                                         ('bsg_expirydate', '<', data.date_to)])
                    if data.expire_date_condition == 'is_set':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_expirydate', '!=', None)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state),
                                                                         ('bsg_expirydate', '!=', None)])
                    if data.expire_date_condition == 'is_not_set':
                            if data.employee_state == 'all':
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_expirydate', '=', None)])
                            else:
                                passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id','in',data.department.ids),
                                                                         ('bsg_employee_id.employee_state', '=',
                                                                          data.employee_state),
                                                                         ('bsg_expirydate', '=', None)])
                    if passport_ids:
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
            if data.grouping_by == 'by_branch':
                if data.department:
                    grand_total=0
                    branch_ids=self.env['bsg_branches.bsg_branches'].search([])
                    for branch_id in branch_ids:
                        if branch_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.branch_id', '=', branch_id.id)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.branch_id', '=', branch_id.id)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            grand_total+=passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Branch Name', main_heading2)
                                sheet.write_string(row, col + 1, str(branch_id.branch_ar_name), main_heading)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Passport NO', main_heading2)
                                sheet.write(row, col + 3, 'Company Name', main_heading2)
                                sheet.write(row, col + 4, 'Department Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 3, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 4, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.branch_id', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.branch_id', '=',None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=',None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=',None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=',None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Branch Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Passport NO', main_heading2)
                        sheet.write(row, col + 3, 'Company Name', main_heading2)
                        sheet.write(row, col + 4, 'Department Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 3, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 4, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_department':
                if data.department:
                    grand_total=0
                    for department_id in data.department:
                        if department_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                            grand_total+=passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Department Name', main_heading2)
                                sheet.write_string(row, col + 1, str(department_id.complete_name), main_heading)
                                sheet.write(row, col + 1, 'اسم القسم', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Passport NO', main_heading2)
                                sheet.write(row, col + 3, 'Company Name', main_heading2)
                                sheet.write(row, col + 4, 'Branch Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 3, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 4, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',  None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Department Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 1, 'اسم القسم', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Passport NO', main_heading2)
                        sheet.write(row, col + 3, 'Company Name', main_heading2)
                        sheet.write(row, col + 4, 'Branch Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 3, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 4, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 4,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_company':
                if data.department:
                    company_ids = self.env['res.company'].search([])
                    grand_total = 0
                    for company_id in company_ids:
                        if company_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                            grand_total += passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Company Name', main_heading2)
                                sheet.write_string(row, col + 1, str(company_id.name), main_heading)
                                sheet.write(row, col + 2, 'اسم الشركة', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Passport NO', main_heading2)
                                sheet.write(row, col + 3, 'Departement Name', main_heading2)
                                sheet.write(row, col + 4, 'Branch Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 4, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', 'in', data.branches.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Company Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'اسم الشركة', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Passport NO', main_heading2)
                        sheet.write(row, col + 3, 'Departement Name', main_heading2)
                        sheet.write(row, col + 4, 'Branch Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 4, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col+ 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_employee_tag':
                if data.department:
                    category_ids = self.env['hr.employee.category'].search([])
                    grand_total = 0
                    for category_id in category_ids:
                        if category_id:
                            passport_list=[]
                            total = 0
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', 'in', data.department.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', 'in', data.department.ids),
                                                                             ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                total += 1
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', 'in', data.department.ids),
                                                                             ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', 'in', data.department.ids),
                                                                             ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', 'in', data.department.ids),
                                                                             ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', 'in', data.department.ids),
                                                                             ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', 'in', data.department.ids),
                                                                             ('bsg_expirydate', '>', data.date_from),
                                                                             ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', 'in', data.department.ids),
                                                                             ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.department_id', 'in', data.department.ids),
                                                                             ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if passport_list:
                                sheet.write(row, col, 'Employee Tag', main_heading2)
                                sheet.write_string(row, col + 1, str(category_id.name), main_heading)
                                sheet.write(row, col + 2, 'علامة الموظف', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Department Name', main_heading2)
                                sheet.write(row, col + 3, 'Branch Name', main_heading2)
                                sheet.write(row, col + 4, 'Company Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport NO', main_heading2)
                                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 11, 'Job Position', main_heading2)
                                sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 14, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 5, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 11, 'وظيفه', main_heading2)
                                sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_list:
                                    if passport:
                                        total += 1
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                        #Unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                grand_total += total
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(total), main_heading)
                                row += 2
                    total=0
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '=', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', 'in', data.department.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if passport_ids:
                        sheet.write(row, col, 'Employee Tag', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'علامة الموظف', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Department Name', main_heading2)
                        sheet.write(row, col + 3, 'Branch Name', main_heading2)
                        sheet.write(row, col + 4, 'Company Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport NO', main_heading2)
                        sheet.write(row, col + 6, 'Passport Name', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date', main_heading2)
                        sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 11, 'Job Position', main_heading2)
                        sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 14, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 5, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 11, 'وظيفه', main_heading2)
                        sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                total += 1
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                                #Unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        grand_total += total
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(total), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_job_position':
                if data.department:
                    job_ids = self.env['hr.job'].search([])
                    grand_total=0
                    for job_id in job_ids:
                        if job_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.department_id', 'in', data.department.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                            grand_total+=passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Job Position', main_heading2)
                                sheet.write_string(row, col + 1, str(job_id.name), main_heading)
                                sheet.write(row, col + 2, 'وظيفه', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Branch Name', main_heading2)
                                sheet.write(row, col + 3, 'Department Name', main_heading2)
                                sheet.write(row, col + 4, 'Passport NO', main_heading2)
                                sheet.write(row, col + 5, 'Company Name', main_heading2)
                                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 4, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 5, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.department_id', 'in', data.department.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Job Position', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'وظيفه', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Branch Name', main_heading2)
                        sheet.write(row, col + 3, 'Department Name', main_heading2)
                        sheet.write(row, col + 4, 'Passport NO', main_heading2)
                        sheet.write(row, col + 5, 'Company Name', main_heading2)
                        sheet.write(row, col + 6, 'Passport Name', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date', main_heading2)
                        sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 4, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 5, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
        if data.mode == 'by_employee_tag':
            if data.grouping_by == 'all':
                sheet.write(row, col, 'Employee ID', main_heading2)
                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                sheet.write(row, col + 2, 'Department Name', main_heading2)
                sheet.write(row, col + 3, 'Branch Name', main_heading2)
                sheet.write(row, col + 4, 'Company Name', main_heading2)
                sheet.write(row, col + 5, 'Passport NO', main_heading2)
                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                sheet.write(row, col + 11, 'Job Position', main_heading2)
                sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                sheet.write(row, col + 14, 'Passport Status', main_heading2)
                #line removed
                row += 1
                sheet.write(row, col, 'هوية الموظف', main_heading2)
                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                sheet.write(row, col + 5, 'رقم جواز السفر', main_heading2)
                sheet.write(row, col + 6, 'اسم جواز السفر', main_heading2)
                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                sheet.write(row, col + 11, 'وظيفه', main_heading2)
                sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                # line removed
                row += 1
                if data.employee_tag:
                    duplicate_passport_list=[]
                    for employee_tag_id in data.employee_tag:
                        if employee_tag_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([])
                                else:
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.employee_state', '=', data.employee_state)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.employee_state', '=', data.employee_state),
                                                                             ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search([ ('bsg_employee_id.employee_state', '=',
                                                                              data.employee_state),
                                                                             ('bsg_expirydate', '!=', data.expiry_date)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.employee_state', '=',
                                                                              data.employee_state),
                                                                             ('bsg_expirydate', '>', data.expiry_date)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([ ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.employee_state', '=',
                                                                              data.employee_state),
                                                                             ('bsg_expirydate', '<', data.expiry_date)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.employee_state', '=',
                                                                              data.employee_state),
                                                                             ('bsg_expirydate', '>=', data.expiry_date)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.employee_state', '=',
                                                                              data.employee_state),
                                                                             ('bsg_expirydate', '<=', data.expiry_date)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '>', data.date_from),
                                                                             ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.employee_state', '=',
                                                                              data.employee_state),
                                                                             ('bsg_expirydate', '>', data.date_from),
                                                                             ('bsg_expirydate', '<', data.date_to)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.employee_state', '=',
                                                                              data.employee_state),
                                                                             ('bsg_expirydate', '!=', None)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.employee_state', '=',
                                                                              data.employee_state),
                                                                             ('bsg_expirydate', '=', None)])
                            if passport_ids:
                                for passport in passport_ids:
                                    if passport:
                                        if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                            if passport.bsg_issuedate:
                                                issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                                # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                                # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                                issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                            else:
                                                issue_date_hijri_str = None
                                                issue_date_gregorian = None
                                           #unnecessary code removed
                                            if passport.bsg_expirydate:
                                                expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                    passport.bsg_expirydate)
                                                # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                                # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                                expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                            else:
                                                expiry_date_hijri_str = None
                                                expiry_date_gregorian = None
                                            sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                               main_heading)
                                            sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                               main_heading)
                                            sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                               main_heading)
                                            sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                               main_heading)
                                            sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                               main_heading)
                                            sheet.write_string(row, col + 3,
                                                               str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                               main_heading)
                                            sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                               main_heading)
                                            sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                               main_heading)
                                            sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                               main_heading)
                                            sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                            sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                            sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                               main_heading)
                                            sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                               main_heading)
                                            sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                            sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                               main_heading)
                                            sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                               main_heading)
                                            sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                               main_heading)
                                            #line removed
                                            duplicate_passport_list.append(passport.id)
                                            row += 1
            if data.grouping_by == 'by_branch':
                if data.employee_tag:
                    grand_total=0
                    branch_ids=self.env['bsg_branches.bsg_branches'].search([])
                    for branch_id in branch_ids:
                        if branch_id:
                            passport_list=[]
                            duplicate_passport_list = []
                            total=0
                            for employee_tag_id in data.employee_tag:
                                if employee_tag_id:
                                    if data.expire_date_condition == 'all':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_not_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '!=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '!=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_after':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '>', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '>', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_before':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '<', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '<', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_after_or_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '>=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '>=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_before_or_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '<=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '<=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_between':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '>', data.date_from),
                                                 ('bsg_expirydate', '<', data.date_to)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '>', data.date_from),
                                                 ('bsg_expirydate', '<', data.date_to),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_set':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '!=', None)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '!=', None),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_not_set':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '=', None)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.branch_id', '=', branch_id.id),
                                                 ('bsg_expirydate', '=', None),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                            if passport_list:
                                sheet.write(row, col, 'Branch Name', main_heading2)
                                sheet.write_string(row, col + 1, str(branch_id.branch_ar_name), main_heading)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Passport NO', main_heading2)
                                sheet.write(row, col + 3, 'Company Name', main_heading2)
                                sheet.write(row, col + 4, 'Department Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 3, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 4, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_list:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                        #Unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        total += 1
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(total), main_heading)
                                grand_total += total
                                row += 2
                    passport_list = []
                    duplicate_passport_list = []
                    total = 0
                    for employee_tag_id in data.employee_tag:
                        if employee_tag_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=',None),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=',None),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=',None),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=',None),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', None),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                    if passport_list:
                        sheet.write(row, col, 'Branch Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Passport NO', main_heading2)
                        sheet.write(row, col + 3, 'Company Name', main_heading2)
                        sheet.write(row, col + 4, 'Department Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 3, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 4, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_list:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                                #Unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                total += 1
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(total), main_heading)
                        grand_total += total
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_department':
                if data.employee_tag:
                    grand_total=0
                    department_ids=self.env['hr.department'].search([])
                    for department_id in department_ids:
                        if department_id:
                            passport_list=[]
                            duplicate_passport_list = []
                            total=0
                            for employee_tag_id in data.employee_tag:
                                if employee_tag_id:
                                    if data.expire_date_condition == 'all':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_not_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '!=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '!=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_after':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '>', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '>', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_before':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '<', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '<', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_after_or_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '>=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '>=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_before_or_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '<=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '<=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_between':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '>', data.date_from),
                                                 ('bsg_expirydate', '<', data.date_to)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '>', data.date_from),
                                                 ('bsg_expirydate', '<', data.date_to),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_set':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '!=', None)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '!=', None),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_not_set':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '=', None)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.department_id', '=', department_id.id),
                                                 ('bsg_expirydate', '=', None),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                            if passport_list:
                                sheet.write(row, col, 'Department Name', main_heading2)
                                sheet.write_string(row, col + 1, str(department_id.complete_name), main_heading)
                                sheet.write(row, col + 1, 'اسم القسم', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Branch Name', main_heading2)
                                sheet.write(row, col + 3, 'Passport NO', main_heading2)
                                sheet.write(row, col + 4, 'Company Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_list:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                        #Unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        total += 1
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(total), main_heading)
                                grand_total += total
                                row += 2
                    passport_list = []
                    duplicate_passport_list = []
                    total = 0
                    for employee_tag_id in data.employee_tag:
                        if employee_tag_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', None),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                    if passport_list:
                        sheet.write(row, col, 'Department Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 1, 'اسم القسم', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Branch Name', main_heading2)
                        sheet.write(row, col + 3, 'Passport NO', main_heading2)
                        sheet.write(row, col + 4, 'Company Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_list:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                                #Unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                total += 1
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(total), main_heading)
                        grand_total += total
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_company':
                if data.employee_tag:
                    grand_total=0
                    company_ids=self.env['res.company'].search([])
                    for company_id in company_ids:
                        if company_id:
                            passport_list=[]
                            duplicate_passport_list = []
                            total=0
                            for employee_tag_id in data.employee_tag:
                                if employee_tag_id:
                                    if data.expire_date_condition == 'all':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_not_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '!=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '!=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_after':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '>', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '>', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_before':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '<', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '<', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_after_or_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '>=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '>=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_before_or_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '<=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '<=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_between':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '>', data.date_from),
                                                 ('bsg_expirydate', '<', data.date_to)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '>', data.date_from),
                                                 ('bsg_expirydate', '<', data.date_to),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_set':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '!=', None)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '!=', None),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_not_set':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '=', None)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.company_id', '=', company_id.id),
                                                 ('bsg_expirydate', '=', None),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                            if passport_list:
                                sheet.write(row, col, 'Company Name', main_heading2)
                                sheet.write_string(row, col + 1, str(company_id.name), main_heading)
                                sheet.write(row, col + 2, 'اسم الشركة', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Passport NO', main_heading2)
                                sheet.write(row, col + 3, 'Departement Name', main_heading2)
                                sheet.write(row, col + 4, 'Branch Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 4, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_list:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                        #Unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        total += 1
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(total), main_heading)
                                grand_total += total
                                row += 2
                    passport_list=[]
                    duplicate_passport_list = []
                    total = 0
                    for employee_tag_id in data.employee_tag:
                        if employee_tag_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=',None),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', None),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                    if passport_list:
                        sheet.write(row, col, 'Company Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'اسم الشركة', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Passport NO', main_heading2)
                        sheet.write(row, col + 3, 'Departement Name', main_heading2)
                        sheet.write(row, col + 4, 'Branch Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 4, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_list:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                                #Unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                total += 1
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(total), main_heading)
                        grand_total += total
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_employee_tag':
                if data.employee_tag:
                    grand_total = 0
                    for employee_tag_id in data.employee_tag:
                        if employee_tag_id:
                            total = 0
                            passport_list=[]
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([ ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '>', data.date_from),
                                                                             ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if passport_list:
                                sheet.write(row, col, 'Employee Tag', main_heading2)
                                sheet.write_string(row, col + 1, str(employee_tag_id.name), main_heading)
                                sheet.write(row, col + 2, 'علامة الموظف', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Department Name', main_heading2)
                                sheet.write(row, col + 3, 'Branch Name', main_heading2)
                                sheet.write(row, col + 4, 'Company Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport NO', main_heading2)
                                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 11, 'Job Position', main_heading2)
                                sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 14, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 5, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 11, 'وظيفه', main_heading2)
                                sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_list:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                        #Unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        total += 1
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(total), main_heading)
                                grand_total += total
                                row += 2
                    total = 0
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.category_ids', '=', False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.employee_state', '=', data.employee_state),('bsg_employee_id.category_ids', '=', False)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '=', data.expiry_date),('bsg_employee_id.category_ids', '=', False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_expirydate', '=', data.expiry_date),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '!=', data.expiry_date),('bsg_employee_id.category_ids', '=', False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_expirydate', '!=', data.expiry_date),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '>', data.expiry_date),('bsg_employee_id.category_ids', '=', False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_expirydate', '>', data.expiry_date),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '<', data.expiry_date),('bsg_employee_id.category_ids', '=', False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_expirydate', '<', data.expiry_date),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '>=', data.expiry_date),('bsg_employee_id.category_ids', '=', False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_expirydate', '>=', data.expiry_date),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '<=', data.expiry_date),('bsg_employee_id.category_ids', '=', False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_expirydate', '<=', data.expiry_date),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '>', data.date_from),('bsg_employee_id.category_ids', '=', False),
                                                                     ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '!=', None),('bsg_employee_id.category_ids', '=', False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_expirydate', '!=', None),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_expirydate', '=', None),('bsg_employee_id.category_ids', '=', False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_expirydate', '=', None),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if passport_ids:
                        sheet.write(row, col, 'Employee Tag', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'علامة الموظف', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Department Name', main_heading2)
                        sheet.write(row, col + 3, 'Branch Name', main_heading2)
                        sheet.write(row, col + 4, 'Company Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport NO', main_heading2)
                        sheet.write(row, col + 6, 'Passport Name', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date', main_heading2)
                        sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 11, 'Job Position', main_heading2)
                        sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 14, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 5, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 11, 'وظيفه', main_heading2)
                        sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                total += 1
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                                #Unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        grand_total += total
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(total), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_job_position':
                if data.employee_tag:
                    grand_total=0
                    job_ids=self.env['hr.job'].search([])
                    for job_id in job_ids:
                        if job_id:
                            passport_list=[]
                            duplicate_passport_list = []
                            total=0
                            for employee_tag_id in data.employee_tag:
                                if employee_tag_id:
                                    if data.expire_date_condition == 'all':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_not_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '!=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '!=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_after':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '>', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '>', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_before':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '<', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '<', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_after_or_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '>=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '>=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_before_or_equal_to':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '<=', data.expiry_date)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '<=', data.expiry_date),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_between':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '>', data.date_from),
                                                 ('bsg_expirydate', '<', data.date_to)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '>', data.date_from),
                                                 ('bsg_expirydate', '<', data.date_to),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_set':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '!=', None)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '!=', None),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                                    if data.expire_date_condition == 'is_not_set':
                                        if data.employee_state == 'all':
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '=', None)])
                                        else:
                                            passport_ids = self.env['hr.passport'].search(
                                                [('bsg_employee_id.job_id', '=', job_id.id),
                                                 ('bsg_expirydate', '=', None),
                                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                        if passport_ids:
                                            for passport in passport_ids:
                                                if passport:
                                                    if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                        passport_list.append(passport)
                                                        duplicate_passport_list.append(passport.id)
                            if passport_list:
                                sheet.write(row, col, 'Job Position', main_heading2)
                                sheet.write_string(row, col + 1, str(job_id.name), main_heading)
                                sheet.write(row, col + 2, 'وظيفه', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Branch Name', main_heading2)
                                sheet.write(row, col + 3, 'Department Name', main_heading2)
                                sheet.write(row, col + 4, 'Passport NO', main_heading2)
                                sheet.write(row, col + 5, 'Company Name', main_heading2)
                                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 4, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 5, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_list:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        total += 1
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(total), main_heading)
                                grand_total += total
                                row += 2
                    passport_list = []
                    duplicate_passport_list = []
                    total = 0
                    for employee_tag_id in data.employee_tag:
                        if employee_tag_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', None),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if employee_tag_id in passport.bsg_employee_id.category_ids and passport.id not in duplicate_passport_list:
                                                passport_list.append(passport)
                                                duplicate_passport_list.append(passport.id)
                    if passport_list:
                        sheet.write(row, col, 'Job Position', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col, 'وظيفه', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Branch Name', main_heading2)
                        sheet.write(row, col + 3, 'Department Name', main_heading2)
                        sheet.write(row, col + 4, 'Passport NO', main_heading2)
                        sheet.write(row, col + 5, 'Company Name', main_heading2)
                        sheet.write(row, col + 6, 'Passport Name', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date', main_heading2)
                        sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 4, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 5, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_list:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                total += 1
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(total), main_heading)
                        grand_total += total
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
        if data.mode == 'by_company':
            if data.grouping_by == 'all':
                sheet.write(row, col, 'Employee ID', main_heading2)
                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                sheet.write(row, col + 2, 'Department Name', main_heading2)
                sheet.write(row, col + 3, 'Branch Name', main_heading2)
                sheet.write(row, col + 4, 'Company Name', main_heading2)
                sheet.write(row, col + 5, 'Passport NO', main_heading2)
                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                sheet.write(row, col + 11, 'Job Position', main_heading2)
                sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                sheet.write(row, col + 14, 'Passport Status', main_heading2)
                #line removed
                row += 1
                sheet.write(row, col, 'هوية الموظف', main_heading2)
                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                sheet.write(row, col + 5, 'رقم جواز السفر', main_heading2)
                sheet.write(row, col + 6, 'اسم جواز السفر', main_heading2)
                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                sheet.write(row, col + 11, 'وظيفه', main_heading2)
                sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                # line removed
                row += 1
                if data.company:
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_employee_id.employee_state', '=', data.employee_state),
                                                                     ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_employee_id.employee_state', '=',
                                                                      data.employee_state),
                                                                     ('bsg_expirydate', '!=', data.expiry_date)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_employee_id.employee_state', '=',
                                                                      data.employee_state),
                                                                     ('bsg_expirydate', '>', data.expiry_date)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_employee_id.employee_state', '=',
                                                                      data.employee_state),
                                                                     ('bsg_expirydate', '<', data.expiry_date)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_employee_id.employee_state', '=',
                                                                      data.employee_state),
                                                                     ('bsg_expirydate', '>=', data.expiry_date)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_employee_id.employee_state', '=',
                                                                      data.employee_state),
                                                                     ('bsg_expirydate', '<=', data.expiry_date)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_expirydate', '>', data.date_from),
                                                                     ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_employee_id.employee_state', '=',
                                                                      data.employee_state),
                                                                     ('bsg_expirydate', '>', data.date_from),
                                                                     ('bsg_expirydate', '<', data.date_to)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_employee_id.employee_state', '=',
                                                                      data.employee_state),
                                                                     ('bsg_expirydate', '!=', None)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id','in',data.company.ids),
                                                                     ('bsg_employee_id.employee_state', '=',
                                                                      data.employee_state),
                                                                     ('bsg_expirydate', '=', None)])
                    if passport_ids:
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
            if data.grouping_by == 'by_branch':
                if data.company:
                    grand_total=0
                    branch_ids=self.env['bsg_branches.bsg_branches'].search([])
                    for branch_id in branch_ids:
                        if branch_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_employee_id.branch_id', '=', branch_id.id)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_employee_id.branch_id', '=', branch_id.id)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id), (
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.branch_id', '=', branch_id.id),(
                                            'bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            grand_total+=passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Branch Name', main_heading2)
                                sheet.write_string(row, col + 1, str(branch_id.branch_ar_name), main_heading)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Department Name', main_heading2)
                                sheet.write(row, col + 3, 'Passport NO', main_heading2)
                                sheet.write(row, col + 4, 'Company Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_employee_id.branch_id', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_employee_id.branch_id', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=',None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=',None),
                                 ('bsg_expirydate', '=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=',None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=',None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=',None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=', None),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.branch_id', '=', None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.branch_id', '=',None), (
                                    'bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Branch Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Department Name', main_heading2)
                        sheet.write(row, col + 3, 'Passport NO', main_heading2)
                        sheet.write(row, col + 4, 'Company Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_department':
                if data.company:
                    grand_total=0
                    department_ids = self.env['hr.department'].search([])
                    for department_id in department_ids:
                        if department_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.department_id', '=', department_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            grand_total+=passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Department Name', main_heading2)
                                sheet.write_string(row, col + 1, str(department_id.complete_name), main_heading)
                                sheet.write(row, col + 1, 'اسم القسم', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Branch Name', main_heading2)
                                sheet.write(row, col + 3, 'Passport NO', main_heading2)
                                sheet.write(row, col + 4, 'Company Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',None),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',None),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=',None),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.department_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.department_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Department Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 1, 'اسم القسم', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Branch Name', main_heading2)
                        sheet.write(row, col + 3, 'Passport NO', main_heading2)
                        sheet.write(row, col + 4, 'Company Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2, str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_company':
                if data.company:
                    grand_total = 0
                    for company_id in data.company:
                        if company_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=',company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=',company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [ ('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                                    passport_count = self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.company_id', '=', company_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None)])
                            grand_total += passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Company Name', main_heading2)
                                sheet.write_string(row, col + 1,str(company_id.name), main_heading)
                                sheet.write(row, col + 2, 'اسم الشركة', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Branch Name', main_heading2)
                                sheet.write(row, col + 3, 'Passport NO', main_heading2)
                                sheet.write(row, col + 4, 'Department Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport Name', main_heading2)
                                sheet.write(row, col + 6, 'Issue Date', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 10, 'Job Position', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 4, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 10, 'وظيفه', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=',None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=',None),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=',None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.company_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Company Name', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'اسم الشركة', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Branch Name', main_heading2)
                        sheet.write(row, col + 3, 'Passport NO', main_heading2)
                        sheet.write(row, col + 4, 'Department Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport Name', main_heading2)
                        sheet.write(row, col + 6, 'Issue Date', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 8, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 10, 'Job Position', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 3, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 4, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 5, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 10, 'وظيفه', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 8, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col+ 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_employee_tag':
                if data.company:
                    category_ids = self.env['hr.employee.category'].search([])
                    grand_total = 0
                    for category_id in category_ids:
                        if category_id:
                            total = 0
                            passport_list=[]
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_expirydate', '=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', 'in', data.company.ids),
                                                                             ('bsg_expirydate', '!=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', 'in', data.company.ids),
                                                                             ('bsg_expirydate', '>', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', 'in', data.company.ids),
                                                                             ('bsg_expirydate', '<', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', 'in', data.company.ids),
                                                                             ('bsg_expirydate', '>=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', 'in', data.company.ids),
                                                                             ('bsg_expirydate', '<=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', 'in', data.company.ids),
                                                                             ('bsg_expirydate', '>', data.date_from),
                                                                             ('bsg_expirydate', '<', data.date_to)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', 'in', data.company.ids),
                                                                             ('bsg_expirydate', '!=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search([('bsg_employee_id.company_id', 'in', data.company.ids),
                                                                             ('bsg_expirydate', '=', None)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                if passport_ids:
                                    for passport in passport_ids:
                                        if passport:
                                            if category_id in passport.bsg_employee_id.category_ids:
                                                passport_list.append(passport)
                            if passport_list:
                                sheet.write(row, col, 'Employee Tag', main_heading2)
                                sheet.write_string(row, col + 1, str(category_id.name), main_heading)
                                sheet.write(row, col + 2, 'علامة الموظف', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Department Name', main_heading2)
                                sheet.write(row, col + 3, 'Branch Name', main_heading2)
                                sheet.write(row, col + 4, 'Company Name', main_heading2)
                                sheet.write(row, col + 5, 'Passport NO', main_heading2)
                                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 11, 'Job Position', main_heading2)
                                sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 14, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 5, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 11, 'وظيفه', main_heading2)
                                sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_list:
                                    if passport:
                                        total += 1
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                        #Unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                                "%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                grand_total += total
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(total), main_heading)
                                row += 2
                    total = 0
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '=', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '<', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '<=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '!=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '=', None)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.company_id', 'in', data.company.ids),('bsg_employee_id.category_ids', '=', False),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if passport_ids:
                        sheet.write(row, col, 'Employee Tag', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col + 2, 'علامة الموظف', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Department Name', main_heading2)
                        sheet.write(row, col + 3, 'Branch Name', main_heading2)
                        sheet.write(row, col + 4, 'Company Name', main_heading2)
                        sheet.write(row, col + 5, 'Passport NO', main_heading2)
                        sheet.write(row, col + 6, 'Passport Name', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date', main_heading2)
                        sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 11, 'Job Position', main_heading2)
                        sheet.write(row, col + 12, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 13, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 14, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 3, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 4, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 5, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 11, 'وظيفه', main_heading2)
                        sheet.write(row, col + 12, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 13, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 14, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                total += 1
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                                #Unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime(
                                        "%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_employee_id.job_id.name), main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 14, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        grand_total += total
                        sheet.write(row, col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(total), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)
            if data.grouping_by == 'by_job_position':
                if data.company:
                    grand_total=0
                    job_ids = self.env['hr.job'].search([])
                    for job_id in job_ids:
                        if job_id:
                            if data.expire_date_condition == 'all':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            if data.expire_date_condition == 'is_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', data.expiry_date)])
                            if data.expire_date_condition == 'is_not_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids),
                                         ('bsg_expirydate', '!=', data.expiry_date)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_after':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_before':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_after_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_before_or_equal_to':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '<=', data.expiry_date),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_between':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '>', data.date_from),
                                         ('bsg_expirydate', '<', data.date_to),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '!=', None)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '!=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            if data.expire_date_condition == 'is_not_set':
                                if data.employee_state == 'all':
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                else:
                                    passport_ids = self.env['hr.passport'].search(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                                    passport_count=self.env['hr.passport'].search_count(
                                        [('bsg_employee_id.job_id', '=', job_id.id),
                                         ('bsg_employee_id.employee_state', '=', data.employee_state),
                                         ('bsg_expirydate', '=', None),
                                         ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            grand_total+=passport_count
                            if passport_ids:
                                sheet.write(row, col, 'Job Position', main_heading2)
                                sheet.write_string(row, col + 1, str(job_id.name), main_heading)
                                sheet.write(row, col, 'وظيفه', main_heading2)
                                row += 1
                                sheet.write(row, col, 'Employee ID', main_heading2)
                                sheet.write(row, col + 1, 'Employee Name', main_heading2)
                                sheet.write(row, col + 2, 'Branch Name', main_heading2)
                                sheet.write(row, col + 3, 'Department Name', main_heading2)
                                sheet.write(row, col + 4, 'Passport NO', main_heading2)
                                sheet.write(row, col + 5, 'Company Name', main_heading2)
                                sheet.write(row, col + 6, 'Passport Name', main_heading2)
                                sheet.write(row, col + 7, 'Issue Date', main_heading2)
                                sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                                sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                                sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                                sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                                sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                                sheet.write(row, col + 13, 'Passport Status', main_heading2)
                                #line removed
                                row += 1
                                sheet.write(row, col, 'هوية الموظف', main_heading2)
                                sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                                sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                                sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                                sheet.write(row, col + 4, ' رقم جواز السفر', main_heading2)
                                sheet.write(row, col + 5, 'اسم الشركة', main_heading2)
                                sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                                sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                                sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                                sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                                sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                                sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                                sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                                sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                                # line removed
                                row += 1
                                for passport in passport_ids:
                                    if passport:
                                        if passport.bsg_issuedate:
                                            issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                            # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                            # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                            issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                        else:
                                            issue_date_hijri_str = None
                                            issue_date_gregorian = None
                                       #unnecessary code removed
                                        if passport.bsg_expirydate:
                                            expiry_date_hijri_str = HijriDate.get_hijri_date(
                                                passport.bsg_expirydate)
                                            # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                            # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                            expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                        else:
                                            expiry_date_hijri_str = None
                                            expiry_date_gregorian = None
                                        sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                           main_heading)
                                        sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 2,
                                                           str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 4, str(passport.bsg_passport_number),
                                                           main_heading)
                                        sheet.write_string(row, col + 5, str(passport.bsg_employee_id.company_id.name),
                                                           main_heading)
                                        sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                           main_heading)
                                        sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                        sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                        sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                           main_heading)
                                        sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                           main_heading)
                                        sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                           main_heading)
                                        sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                           main_heading)
                                        #line removed
                                        row += 1
                                sheet.write(row, col, 'Total', main_heading2)
                                sheet.write_string(row, col + 1, str(passport_count), main_heading)
                                row += 2
                    if data.expire_date_condition == 'all':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state)])
                    if data.expire_date_condition == 'is_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', data.expiry_date)])
                    if data.expire_date_condition == 'is_not_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids),
                                 ('bsg_expirydate', '!=', data.expiry_date)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_after':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_before':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_after_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=',None),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_before_or_equal_to':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '<=', data.expiry_date),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_between':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '>', data.date_from),
                                 ('bsg_expirydate', '<', data.date_to),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '!=', None)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '!=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    if data.expire_date_condition == 'is_not_set':
                        if data.employee_state == 'all':
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=',None),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=',None),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                        else:
                            passport_ids = self.env['hr.passport'].search(
                                [('bsg_employee_id.job_id', '=',None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                            passport_count = self.env['hr.passport'].search_count(
                                [('bsg_employee_id.job_id', '=', None),
                                 ('bsg_employee_id.employee_state', '=', data.employee_state),
                                 ('bsg_expirydate', '=', None),
                                 ('bsg_employee_id.company_id', 'in', data.company.ids)])
                    grand_total += passport_count
                    if passport_ids:
                        sheet.write(row, col, 'Job Position', main_heading2)
                        sheet.write_string(row, col + 1, 'Undefined', main_heading)
                        sheet.write(row, col, 'وظيفه', main_heading2)
                        row += 1
                        sheet.write(row, col, 'Employee ID', main_heading2)
                        sheet.write(row, col + 1, 'Employee Name', main_heading2)
                        sheet.write(row, col + 2, 'Branch Name', main_heading2)
                        sheet.write(row, col + 3, 'Department Name', main_heading2)
                        sheet.write(row, col + 4, 'Passport NO', main_heading2)
                        sheet.write(row, col + 5, 'Company Name', main_heading2)
                        sheet.write(row, col + 6, 'Passport Name', main_heading2)
                        sheet.write(row, col + 7, 'Issue Date', main_heading2)
                        sheet.write(row, col + 8, 'Issue Date Hijri', main_heading2)
                        sheet.write(row, col + 9, 'Expiry Date', main_heading2)
                        sheet.write(row, col + 10, 'Expiry Date Hijri', main_heading2)
                        sheet.write(row, col + 11, 'Passport Issue Country', main_heading2)
                        sheet.write(row, col + 12, 'Place Of Issue', main_heading2)
                        sheet.write(row, col + 13, 'Passport Status', main_heading2)
                        #line removed
                        row += 1
                        sheet.write(row, col, 'هوية الموظف', main_heading2)
                        sheet.write(row, col + 1, 'اسم الموظف', main_heading2)
                        sheet.write(row, col + 2, 'اسم الفرع', main_heading2)
                        sheet.write(row, col + 3, 'اسم القسم', main_heading2)
                        sheet.write(row, col + 4, ' رقم جواز السفر', main_heading2)
                        sheet.write(row, col + 5, 'اسم الشركة', main_heading2)
                        sheet.write(row, col + 6, ' اسم جواز السفر', main_heading2)
                        sheet.write(row, col + 7, 'تاريخ الاصدار', main_heading2)
                        sheet.write(row, col + 8, 'تاريخ الإصدار الهجري', main_heading2)
                        sheet.write(row, col + 9, 'تاريخ الانتهاء', main_heading2)
                        sheet.write(row, col + 10, 'تاريخ الانتهاء هجري', main_heading2)
                        sheet.write(row, col + 11, 'بلد إصدار جواز السفر', main_heading2)
                        sheet.write(row, col + 12, 'مكان صدوره', main_heading2)
                        sheet.write(row, col + 13, 'حالة جواز السفر', main_heading2)
                        # line removed
                        row += 1
                        for passport in passport_ids:
                            if passport:
                                if passport.bsg_issuedate:
                                    issue_date_hijri_str = HijriDate.get_hijri_date(passport.bsg_issuedate)
                                    # issue_date_hijri_obj = datetime.strptime(issue_date_hijri_str,'%Y-%m-%d')
                                    # issue_date_hijri = issue_date_hijri_obj.strftime("%m/%d/%Y")
                                    issue_date_gregorian = passport.bsg_issuedate.strftime("%m/%d/%Y")
                                else:
                                    issue_date_hijri_str = None
                                    issue_date_gregorian = None
                               #unnecessary code removed
                                if passport.bsg_expirydate:
                                    expiry_date_hijri_str = HijriDate.get_hijri_date(
                                        passport.bsg_expirydate)
                                    # expiry_date_hijri_obj = datetime.strptime(expiry_date_hijri_str, '%Y-%m-%d')
                                    # expiry_date_hijri = expiry_date_hijri_obj.strftime("%m/%d/%Y")
                                    expiry_date_gregorian = passport.bsg_expirydate.strftime("%m/%d/%Y")
                                else:
                                    expiry_date_hijri_str = None
                                    expiry_date_gregorian = None
                                sheet.write_string(row, col, str(passport.bsg_employee_id.driver_code),
                                                   main_heading)
                                sheet.write_string(row, col + 1, str(passport.bsg_employee_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 2,
                                                   str(passport.bsg_employee_id.branch_id.branch_ar_name),
                                                   main_heading)
                                sheet.write_string(row, col + 3, str(passport.bsg_employee_id.department_id.complete_name),
                                                   main_heading)
                                sheet.write_string(row, col + 4, str(passport.bsg_passport_number),
                                                   main_heading)
                                sheet.write_string(row, col + 5, str(passport.bsg_employee_id.company_id.name),
                                                   main_heading)
                                sheet.write_string(row, col + 6, str(passport.bsg_passport_name),
                                                   main_heading)
                                sheet.write_string(row, col + 7, str(issue_date_gregorian), main_heading)
                                sheet.write_string(row, col + 8, str(issue_date_hijri_str), main_heading)
                                sheet.write_string(row, col + 9, str(expiry_date_gregorian),
                                                   main_heading)
                                sheet.write_string(row, col + 10, str(expiry_date_hijri_str),
                                                   main_heading)
                                sheet.write_string(row, col + 11, str(passport.bsg_passport_issue_country),
                                                   main_heading)
                                sheet.write_string(row, col + 12, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                sheet.write_string(row, col + 13, str(passport.bsg_passport_issue_place),
                                                   main_heading)
                                #line removed
                                row += 1
                        sheet.write(row,col, 'Total', main_heading2)
                        sheet.write_string(row, col + 1, str(passport_count), main_heading)
                        row += 2
                    sheet.write(row, col, 'Grand Total', main_heading2)
                    sheet.write_string(row, col + 1, str(grand_total), main_heading)















































































